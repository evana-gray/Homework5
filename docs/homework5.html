<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>homework5</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-d4be639c637f3db3c684c66cefad7e0c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="fullcontent">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">homework5</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyverse' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyr' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readr' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'dplyr' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'stringr' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'forcats' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'lubridate' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   4.0.0     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'psych' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'psych'

The following objects are masked from 'package:ggplot2':

    %+%, alpha</code></pre>
</div>
</div>
<section id="read-in-uci-data" class="level1">
<h1>Read in UCI Data</h1>
<p>Initially read in data using provided code including the merge-join based on original 13 variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#use r code provided in download... already suitable to read files from project folder</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>d1<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">"student-mat.csv"</span>,<span class="at">sep=</span><span class="st">";"</span>,<span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>d2<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">"student-por.csv"</span>,<span class="at">sep=</span><span class="st">";"</span>,<span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>d3<span class="ot">=</span><span class="fu">merge</span>(d1,d2,<span class="at">by=</span><span class="fu">c</span>(<span class="st">"school"</span>,<span class="st">"sex"</span>,<span class="st">"age"</span>,<span class="st">"address"</span>,<span class="st">"famsize"</span>,<span class="st">"Pstatus"</span>,<span class="st">"Medu"</span>,<span class="st">"Fedu"</span>,<span class="st">"Mjob"</span>,<span class="st">"Fjob"</span>,<span class="st">"reason"</span>,<span class="st">"nursery"</span>,<span class="st">"internet"</span>))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">#print(nrow(d3)) # 382 students</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tidyverse-read-in-data" class="level1">
<h1>Tidyverse Read in Data</h1>
<p>Use tidyverse functions to read in data and use original 13 suggested variables as inner join criteria. This leads to a many:many relationship which suggests the 13 field combinations are not specific enough.</p>
<ul>
<li><p>The Mat dataset shows student demographic information and test scores from a mathematics class. This is the “LEFT” dataset in the join and data elements exclusive to it end in “.x”</p></li>
<li><p>The Por dataset shows student demographic information and test scores from a Portuguese class. This is the “RIGHT” dataset in the join and data elements exclusive to it end in “.y”</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#same work done using tidyverse functions</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">read_delim</span>(<span class="st">"student-mat.csv"</span>, <span class="at">delim =</span> <span class="st">";"</span>, <span class="at">col_names =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 395 Columns: 33
── Column specification ────────────────────────────────────────────────────────
Delimiter: ";"
chr (17): school, sex, address, famsize, Pstatus, Mjob, Fjob, reason, guardi...
dbl (16): age, Medu, Fedu, traveltime, studytime, failures, famrel, freetime...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>por <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">read_delim</span>(<span class="st">"student-por.csv"</span>, <span class="at">delim =</span> <span class="st">";"</span>, <span class="at">col_names =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 649 Columns: 33
── Column specification ────────────────────────────────────────────────────────
Delimiter: ";"
chr (17): school, sex, address, famsize, Pstatus, Mjob, Fjob, reason, guardi...
dbl (16): age, Medu, Fedu, traveltime, studytime, failures, famrel, freetime...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#result is many:many join - these fields are not specific enough</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>InitialJoin <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(mat, por, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">"school"</span>,<span class="st">"sex"</span>,<span class="st">"age"</span>,<span class="st">"address"</span>,<span class="st">"famsize"</span>,<span class="st">"Pstatus"</span>,<span class="st">"Medu"</span>,<span class="st">"Fedu"</span>,<span class="st">"Mjob"</span>,<span class="st">"Fjob"</span>,<span class="st">"reason"</span>,<span class="st">"nursery"</span>,<span class="st">"internet"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in inner_join(mat, por, by = join_by("school", "sex", "age", "address", : Detected an unexpected many-to-many relationship between `x` and `y`.
ℹ Row 79 of `x` matches multiple rows in `y`.
ℹ Row 79 of `y` matches multiple rows in `x`.
ℹ If a many-to-many relationship is expected, set `relationship =
  "many-to-many"` to silence this warning.</code></pre>
</div>
</div>
</section>
<section id="assign-factors-for-categorical-variables" class="level1">
<h1>Assign factors for categorical variables</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">&lt;-</span>  mat <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">health_f =</span> <span class="fu">factor</span>(health,<span class="at">levels =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)),</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"very bad"</span>,<span class="st">"bad"</span>,<span class="st">"neutral"</span>,<span class="st">"good"</span>,<span class="st">"very good"</span>)),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Walc_f =</span> <span class="fu">factor</span>(Walc,<span class="at">levels =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"very low"</span>, <span class="st">"low"</span>, <span class="st">"0-avg"</span>,<span class="st">"high"</span>,<span class="st">"very high"</span>)),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dalc_f =</span> <span class="fu">factor</span>(Dalc,<span class="at">levels =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)),</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"very low"</span>, <span class="st">"low"</span>, <span class="st">"0-avg"</span>,<span class="st">"high"</span>,<span class="st">"very high"</span>)),</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">studytime_f =</span> <span class="fu">factor</span>(studytime,<span class="at">levels =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)),</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"&lt;2 hours"</span>, <span class="st">"2-5 hours"</span>, <span class="st">"5-10 hours"</span>,<span class="st">"&gt;10 hours"</span>))</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>por <span class="ot">&lt;-</span>  por <span class="sc">|&gt;</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">health_f =</span> <span class="fu">factor</span>(health,<span class="at">levels =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)),</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"very bad"</span>,<span class="st">"bad"</span>,<span class="st">"neutral"</span>,<span class="st">"good"</span>,<span class="st">"very good"</span>)),</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Walc_f =</span> <span class="fu">factor</span>(Walc,<span class="at">levels =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)),</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"very low"</span>, <span class="st">"low"</span>, <span class="st">"0-avg"</span>,<span class="st">"high"</span>,<span class="st">"very high"</span>)),</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dalc_f =</span> <span class="fu">factor</span>(Dalc,<span class="at">levels =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)),</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"very low"</span>, <span class="st">"low"</span>, <span class="st">"0-avg"</span>,<span class="st">"high"</span>,<span class="st">"very high"</span>)),</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">studytime_f =</span> <span class="fu">factor</span>(studytime,<span class="at">levels =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)),</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"&lt;2 hours"</span>, <span class="st">"2-5 hours"</span>, <span class="st">"5-10 hours"</span>,<span class="st">"&gt;10 hours"</span>))</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="final-join" class="level1">
<h1>Final Join</h1>
<p>This inner join uses all variables EXCEPT G1, G2, G3, paid and absences. The four factor variables are also excluded as join criteria.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#join by every field except response variables</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co">#no many:many join message</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(mat, por, </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">by =</span> <span class="fu">names</span>(<span class="fu">select</span>(mat,<span class="fu">everything</span>(), <span class="sc">-</span><span class="fu">c</span>(<span class="st">"G1"</span>,<span class="st">"G2"</span>,<span class="st">"G3"</span>,<span class="st">"paid"</span>,<span class="st">"absences"</span>,<span class="st">"health_f"</span>,<span class="st">"Walc_f"</span>,<span class="st">"Dalc_f"</span>,<span class="st">"studytime_f"</span>)))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co">#clear initial imports out of environment</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(d1,d2,d3,InitialJoin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="initial-eda" class="level1">
<h1>Initial EDA</h1>
<p>These analyses demonstrate:</p>
<ol type="1">
<li>The full combined dataset.</li>
<li>Descriptive statistics for all dataset variables. Some of the variables are coded in such a way that many statistics such as the “address” field having a numeric mean.</li>
<li>Two methods are used to find missing data values - there are no missing values for any variable in the dataset.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#view tibble - observe sample of values</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>combined</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 320 × 46
   school sex     age address famsize Pstatus  Medu  Fedu Mjob     Fjob   reason
   &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt; 
 1 GP     F        18 U       GT3     A           4     4 at_home  teach… course
 2 GP     F        17 U       GT3     T           1     1 at_home  other  course
 3 GP     F        15 U       GT3     T           4     2 health   servi… home  
 4 GP     F        16 U       GT3     T           3     3 other    other  home  
 5 GP     M        16 U       LE3     T           4     3 services other  reput…
 6 GP     M        16 U       LE3     T           2     2 other    other  home  
 7 GP     F        17 U       GT3     A           4     4 other    teach… home  
 8 GP     M        15 U       LE3     A           3     2 services other  home  
 9 GP     M        15 U       GT3     T           3     4 other    other  home  
10 GP     F        15 U       GT3     T           4     4 teacher  health reput…
# ℹ 310 more rows
# ℹ 35 more variables: guardian &lt;chr&gt;, traveltime &lt;dbl&gt;, studytime &lt;dbl&gt;,
#   failures &lt;dbl&gt;, schoolsup &lt;chr&gt;, famsup &lt;chr&gt;, paid.x &lt;chr&gt;,
#   activities &lt;chr&gt;, nursery &lt;chr&gt;, higher &lt;chr&gt;, internet &lt;chr&gt;,
#   romantic &lt;chr&gt;, famrel &lt;dbl&gt;, freetime &lt;dbl&gt;, goout &lt;dbl&gt;, Dalc &lt;dbl&gt;,
#   Walc &lt;dbl&gt;, health &lt;dbl&gt;, absences.x &lt;dbl&gt;, G1.x &lt;dbl&gt;, G2.x &lt;dbl&gt;,
#   G3.x &lt;dbl&gt;, health_f.x &lt;fct&gt;, Walc_f.x &lt;fct&gt;, Dalc_f.x &lt;fct&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#use describe() to get descriptive statistics on all variables</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">describe</span>(combined)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               vars   n  mean   sd median trimmed  mad min max range  skew
school*           1 320  1.10 0.30    1.0    1.00 0.00   1   2     1  2.60
sex*              2 320  1.46 0.50    1.0    1.45 0.00   1   2     1  0.17
age               3 320 16.52 1.14   16.0   16.49 1.48  15  22     7  0.43
address*          4 320  1.79 0.41    2.0    1.86 0.00   1   2     1 -1.42
famsize*          5 320  1.28 0.45    1.0    1.23 0.00   1   2     1  0.97
Pstatus*          6 320  1.90 0.30    2.0    2.00 0.00   1   2     1 -2.71
Medu              7 320  2.87 1.07    3.0    2.97 1.48   0   4     4 -0.43
Fedu              8 320  2.62 1.09    3.0    2.66 1.48   0   4     4 -0.16
Mjob*             9 320  3.21 1.24    3.0    3.26 1.48   1   5     4 -0.29
Fjob*            10 320  3.31 0.86    3.0    3.32 0.00   1   5     4 -0.25
reason*          11 320  2.26 1.21    2.0    2.20 1.48   1   4     3  0.40
guardian*        12 320  1.80 0.47    2.0    1.84 0.00   1   3     2 -0.60
traveltime       13 320  1.43 0.69    1.0    1.29 0.00   1   4     3  1.65
studytime        14 320  2.08 0.87    2.0    2.00 1.48   1   4     3  0.59
failures         15 320  0.08 0.39    0.0    0.00 0.00   0   3     3  5.92
schoolsup*       16 320  1.13 0.34    1.0    1.04 0.00   1   2     1  2.13
famsup*          17 320  1.63 0.48    2.0    1.67 0.00   1   2     1 -0.56
paid.x*          18 320  1.50 0.50    1.5    1.50 0.74   1   2     1  0.00
activities*      19 320  1.53 0.50    2.0    1.54 0.00   1   2     1 -0.12
nursery*         20 320  1.82 0.39    2.0    1.89 0.00   1   2     1 -1.62
higher*          21 320  1.98 0.15    2.0    2.00 0.00   1   2     1 -6.51
internet*        22 320  1.85 0.36    2.0    1.94 0.00   1   2     1 -1.95
romantic*        23 320  1.31 0.46    1.0    1.26 0.00   1   2     1  0.82
famrel           24 320  3.99 0.89    4.0    4.08 1.48   1   5     4 -0.98
freetime         25 320  3.20 0.97    3.0    3.20 1.48   1   5     4 -0.14
goout            26 320  3.07 1.10    3.0    3.04 1.48   1   5     4  0.16
Dalc             27 320  1.44 0.88    1.0    1.21 0.00   1   5     4  2.34
Walc             28 320  2.22 1.26    2.0    2.08 1.48   1   5     4  0.68
health           29 320  3.52 1.42    4.0    3.65 1.48   1   5     4 -0.49
absences.x       30 320  5.41 7.84    4.0    4.00 5.93   0  75    75  4.25
G1.x             31 320 11.29 3.20   11.0   11.19 2.97   5  19    14  0.27
G2.x             32 320 11.18 3.67   11.0   11.29 2.97   0  19    19 -0.45
G3.x             33 320 11.04 4.30   11.0   11.38 4.45   0  20    20 -0.76
health_f.x*      34 320  3.52 1.42    4.0    3.65 1.48   1   5     4 -0.49
Walc_f.x*        35 320  2.22 1.26    2.0    2.08 1.48   1   5     4  0.68
Dalc_f.x*        36 320  1.44 0.88    1.0    1.21 0.00   1   5     4  2.34
studytime_f.x*   37 320  2.08 0.87    2.0    2.00 1.48   1   4     3  0.59
paid.y*          38 320  1.06 0.24    1.0    1.00 0.00   1   2     1  3.60
absences.y       39 320  3.25 4.56    2.0    2.33 2.97   0  32    32  2.53
G1.y             40 320 12.39 2.56   12.0   12.41 2.97   0  19    19 -0.31
G2.y             41 320 12.57 2.42   12.0   12.52 2.97   5  19    14  0.20
G3.y             42 320 12.88 2.89   13.0   12.97 2.97   0  19    19 -1.13
health_f.y*      43 320  3.52 1.42    4.0    3.65 1.48   1   5     4 -0.49
Walc_f.y*        44 320  2.22 1.26    2.0    2.08 1.48   1   5     4  0.68
Dalc_f.y*        45 320  1.44 0.88    1.0    1.21 0.00   1   5     4  2.34
studytime_f.y*   46 320  2.08 0.87    2.0    2.00 1.48   1   4     3  0.59
               kurtosis   se
school*            4.76 0.02
sex*              -1.98 0.03
age                0.35 0.06
address*           0.02 0.02
famsize*          -1.07 0.03
Pstatus*           5.38 0.02
Medu              -1.03 0.06
Fedu              -1.16 0.06
Mjob*             -0.71 0.07
Fjob*              0.90 0.05
reason*           -1.41 0.07
guardian*          0.21 0.03
traveltime         2.46 0.04
studytime         -0.20 0.05
failures          38.64 0.02
schoolsup*         2.56 0.02
famsup*           -1.70 0.03
paid.x*           -2.01 0.03
activities*       -1.99 0.03
nursery*           0.63 0.02
higher*           40.46 0.01
internet*          1.81 0.02
romantic*         -1.33 0.03
famrel             1.21 0.05
freetime          -0.27 0.05
goout             -0.73 0.06
Dalc               5.32 0.05
Walc              -0.69 0.07
health            -1.07 0.08
absences.x        27.83 0.44
G1.x              -0.70 0.18
G2.x               0.62 0.21
G3.x               0.75 0.24
health_f.x*       -1.07 0.08
Walc_f.x*         -0.69 0.07
Dalc_f.x*          5.32 0.05
studytime_f.x*    -0.20 0.05
paid.y*           10.98 0.01
absences.y         9.37 0.25
G1.y               1.08 0.14
G2.y              -0.19 0.14
G3.y               4.18 0.16
health_f.y*       -1.07 0.08
Walc_f.y*         -0.69 0.07
Dalc_f.y*          5.32 0.05
studytime_f.y*    -0.20 0.05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#determine missing rate using function in lecture</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="do">##no missing values identified throughout entire dataset</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(combined))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       school           sex           age       address       famsize 
            0             0             0             0             0 
      Pstatus          Medu          Fedu          Mjob          Fjob 
            0             0             0             0             0 
       reason      guardian    traveltime     studytime      failures 
            0             0             0             0             0 
    schoolsup        famsup        paid.x    activities       nursery 
            0             0             0             0             0 
       higher      internet      romantic        famrel      freetime 
            0             0             0             0             0 
        goout          Dalc          Walc        health    absences.x 
            0             0             0             0             0 
         G1.x          G2.x          G3.x    health_f.x      Walc_f.x 
            0             0             0             0             0 
     Dalc_f.x studytime_f.x        paid.y    absences.y          G1.y 
            0             0             0             0             0 
         G2.y          G3.y    health_f.y      Walc_f.y      Dalc_f.y 
            0             0             0             0             0 
studytime_f.y 
            0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>sum_na <span class="ot">&lt;-</span> <span class="cf">function</span>(column){</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">is.na</span>(column))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>na_counts <span class="ot">&lt;-</span> combined <span class="sc">|&gt;</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), sum_na))</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>na_counts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 46
  school   sex   age address famsize Pstatus  Medu  Fedu  Mjob  Fjob reason
   &lt;int&gt; &lt;int&gt; &lt;int&gt;   &lt;int&gt;   &lt;int&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;int&gt;
1      0     0     0       0       0       0     0     0     0     0      0
# ℹ 35 more variables: guardian &lt;int&gt;, traveltime &lt;int&gt;, studytime &lt;int&gt;,
#   failures &lt;int&gt;, schoolsup &lt;int&gt;, famsup &lt;int&gt;, paid.x &lt;int&gt;,
#   activities &lt;int&gt;, nursery &lt;int&gt;, higher &lt;int&gt;, internet &lt;int&gt;,
#   romantic &lt;int&gt;, famrel &lt;int&gt;, freetime &lt;int&gt;, goout &lt;int&gt;, Dalc &lt;int&gt;,
#   Walc &lt;int&gt;, health &lt;int&gt;, absences.x &lt;int&gt;, G1.x &lt;int&gt;, G2.x &lt;int&gt;,
#   G3.x &lt;int&gt;, health_f.x &lt;int&gt;, Walc_f.x &lt;int&gt;, Dalc_f.x &lt;int&gt;,
#   studytime_f.x &lt;int&gt;, paid.y &lt;int&gt;, absences.y &lt;int&gt;, G1.y &lt;int&gt;, …</code></pre>
</div>
</div>
</section>
<section id="contingency-tables" class="level1">
<h1>Contingency Tables</h1>
<section id="simple-one-way-contingency" class="level2">
<h2 class="anchored" data-anchor-id="simple-one-way-contingency">Simple one way contingency</h2>
<p>This one way contingency table shows the number of students residing in each address type (R= Rural / U=Urban)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#one way contingency table</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(combined<span class="sc">$</span>address)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  R   U 
 67 253 </code></pre>
</div>
</div>
</section>
<section id="two-way-and-three-way-contingency" class="level2">
<h2 class="anchored" data-anchor-id="two-way-and-three-way-contingency">Two way and three way contingency</h2>
<p>Below are a two way and a three way contingency table. The two way shows the mother’s job by address type. The three way contingency table shows the first two way contingency table with its values split by a 3rd dimension the presence of family educational support (yes/no).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#two way contingency table </span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(combined<span class="sc">$</span>Mjob, combined<span class="sc">$</span>address)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          
            R  U
  at_home  18 26
  health    3 27
  other    23 93
  services 12 63
  teacher  11 44</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#three way contingency table</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(combined<span class="sc">$</span>Mjob, combined<span class="sc">$</span>address, combined<span class="sc">$</span>famsup)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>, ,  = no

          
            R  U
  at_home   7 10
  health    1  6
  other    11 41
  services  2 22
  teacher   4 13

, ,  = yes

          
            R  U
  at_home  11 16
  health    2 21
  other    12 52
  services 10 41
  teacher   7 31</code></pre>
</div>
</div>
</section>
<section id="conditional-two-way-table" class="level2">
<h2 class="anchored" data-anchor-id="conditional-two-way-table">Conditional two way table</h2>
<p>These two contingency tables demonstrate multiple ways to subset contingency table data - the first uses a filter function, and the second filters based on the 2nd item of the 3rd array dimension. Both methods return identical data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#conditional two way table - observe study time by sex where address is rural </span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co">#create data subset before table()</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>ruraldata <span class="ot">&lt;-</span> combined <span class="sc">|&gt;</span> </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(address <span class="sc">==</span> <span class="st">"U"</span>) </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ruraldata<span class="sc">$</span>sex, ruraldata<span class="sc">$</span>studytime_f.x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
    &lt;2 hours 2-5 hours 5-10 hours &gt;10 hours
  F       18        78         32        11
  M       41        54         10         9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#conditional two way table - observe study time by sex where address is urban</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>twoway_2 <span class="ot">&lt;-</span> <span class="fu">table</span>(combined<span class="sc">$</span>sex, combined<span class="sc">$</span>studytime_f.x, combined<span class="sc">$</span>address)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>twoway_2[,,<span class="dv">2</span>] <span class="co">#selecting for urban [sex row, study time column,rural/urban]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
    &lt;2 hours 2-5 hours 5-10 hours &gt;10 hours
  F       18        78         32        11
  M       41        54         10         9</code></pre>
</div>
</div>
</section>
<section id="dplyr-contingency-table" class="level2">
<h2 class="anchored" data-anchor-id="dplyr-contingency-table">dplyr contingency table</h2>
<p>Dplyr group_by and summarize functions are used to create counts by weekly alcohol use and health status. This original structure included a row for each combination of the two categorical variables. Pivot wider creates new columns from repeating values from an existing column - Walc_f.x.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#observe count of health status across levels of reported weekly alcohol use</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co">#reorient data using pivot_wider()</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>combined <span class="sc">|&gt;</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(health_f.x, Walc_f.x) <span class="sc">|&gt;</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> health_f.x, <span class="at">values_from =</span> count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'health_f.x'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 6
  Walc_f.x  `very bad`   bad neutral  good `very good`
  &lt;fct&gt;          &lt;int&gt; &lt;int&gt;   &lt;int&gt; &lt;int&gt;       &lt;int&gt;
1 very low          19    12      31    25          41
2 low               10     6      18     9          28
3 0-avg              9    11      11    12          19
4 high               4     4       5     4          22
5 very high          2     1       5     5           7</code></pre>
</div>
</div>
</section>
</section>
<section id="initial-bar-plots" class="level1">
<h1>Initial Bar Plots</h1>
<section id="compare-stacked-with-side-by-side" class="level2">
<h2 class="anchored" data-anchor-id="compare-stacked-with-side-by-side">Compare stacked with side by side</h2>
<p>Two simple bar plots were created to demonstrate the different ways multiple categorical variables can be shown in a bar plot. One shows the total counts for the two groups stacked on top of each other. The other shows the two groups side-by-side, which can be easier to quickly read and interpret.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#stacked bar plot</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(combined, <span class="fu">aes</span>(<span class="at">x =</span> health_f.x, <span class="at">fill =</span> address)) <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Stacked Bar Chart"</span>,<span class="at">x =</span> <span class="st">"Health"</span>, <span class="at">y =</span> <span class="st">"Observations"</span>) <span class="sc">+</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="homework5_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#side by side bar plot</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(combined, <span class="fu">aes</span>(<span class="at">x =</span> health_f.x, <span class="at">fill =</span> address)) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Side by Side Bar Chart"</span>, <span class="at">x =</span> <span class="st">"Health"</span>, <span class="at">y =</span> <span class="st">"Observations"</span>) <span class="sc">+</span> </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="homework5_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="numeric-variables" class="level1">
<h1>Numeric Variables</h1>
<p>5 measures of center and spread: mean, median, variance, standard deviation, and interquartile range were used to describe three numeric variables (student age, mathematics class absences, and the final G3 mathematics assessment score.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Measures of Center and Spread</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>fxlist <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"mean"</span> <span class="ot">=</span> mean, <span class="st">"median"</span> <span class="ot">=</span> median, <span class="st">"var"</span> <span class="ot">=</span> var, <span class="st">"sd"</span> <span class="ot">=</span> sd, <span class="st">"IQR"</span> <span class="ot">=</span> IQR)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>MeasureAndSpread1 <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>combined <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="fu">across</span>(age,<span class="at">.fns =</span> fxlist,<span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span>)),</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>combined <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="fu">across</span>(absences.x,<span class="at">.fns =</span> fxlist,<span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span>)),</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>combined <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="fu">across</span>(G3.x,<span class="at">.fns =</span> fxlist,<span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span>))</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>MeasureAndSpread1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 1 × 5
  age_mean age_median age_var age_sd age_IQR
     &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1     16.5         16    1.30   1.14       1

[[2]]
# A tibble: 1 × 5
  absences.x_mean absences.x_median absences.x_var absences.x_sd absences.x_IQR
            &lt;dbl&gt;             &lt;dbl&gt;          &lt;dbl&gt;         &lt;dbl&gt;          &lt;dbl&gt;
1            5.41                 4           61.4          7.84           7.25

[[3]]
# A tibble: 1 × 5
  G3.x_mean G3.x_median G3.x_var G3.x_sd G3.x_IQR
      &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
1      11.0          11     18.5    4.30        5</code></pre>
</div>
</div>
<p>The tables below take a similar approach to the first but have added a grouping variable, school. This helps one understand differences in students across the schools.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Overall age absences and G3 across school</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>MeasureAndSpread2 <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>combined <span class="sc">|&gt;</span> <span class="fu">group_by</span>(school)<span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="fu">across</span>(age,<span class="at">.fns =</span> fxlist,<span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span>)),</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>combined <span class="sc">|&gt;</span> <span class="fu">group_by</span>(school)<span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="fu">across</span>(absences.x,<span class="at">.fns =</span> fxlist,<span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span>)),</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>combined <span class="sc">|&gt;</span> <span class="fu">group_by</span>(school)<span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="fu">across</span>(G3.x,<span class="at">.fns =</span> fxlist,<span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span>))</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>MeasureAndSpread2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 2 × 6
  school age_mean age_median age_var age_sd age_IQR
  &lt;chr&gt;     &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1 GP         16.4         16   1.21   1.10        1
2 MS         17.8         18   0.360  0.600       1

[[2]]
# A tibble: 2 × 6
  school absences.x_mean absences.x_median absences.x_var absences.x_sd
  &lt;chr&gt;            &lt;dbl&gt;             &lt;dbl&gt;          &lt;dbl&gt;         &lt;dbl&gt;
1 GP                5.64                 4           65.7          8.10
2 MS                3.42                 2           20.7          4.55
# ℹ 1 more variable: absences.x_IQR &lt;dbl&gt;

[[3]]
# A tibble: 2 × 6
  school G3.x_mean G3.x_median G3.x_var G3.x_sd G3.x_IQR
  &lt;chr&gt;      &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
1 GP         11.2           11     18.3    4.27        5
2 MS          9.88          10     19.7    4.44        4</code></pre>
</div>
</div>
<p>Below the same information is repeated with a subset for the GP school.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#subset for GP school</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>combinedgp <span class="ot">&lt;-</span> <span class="fu">filter</span>(combined,school <span class="sc">==</span> <span class="st">"GP"</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>MeasureAndSpread3 <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>combinedgp <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="fu">across</span>(age,<span class="at">.fns =</span> fxlist,<span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span>)),</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>combinedgp <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="fu">across</span>(absences.x,<span class="at">.fns =</span> fxlist,<span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span>)),</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>combinedgp <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="fu">across</span>(G3.x,<span class="at">.fns =</span> fxlist,<span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span>))</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>MeasureAndSpread3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 1 × 5
  age_mean age_median age_var age_sd age_IQR
     &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1     16.4         16    1.21   1.10       1

[[2]]
# A tibble: 1 × 5
  absences.x_mean absences.x_median absences.x_var absences.x_sd absences.x_IQR
            &lt;dbl&gt;             &lt;dbl&gt;          &lt;dbl&gt;         &lt;dbl&gt;          &lt;dbl&gt;
1            5.64                 4           65.7          8.10              8

[[3]]
# A tibble: 1 × 5
  G3.x_mean G3.x_median G3.x_var G3.x_sd G3.x_IQR
      &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
1      11.2          11     18.3    4.27        5</code></pre>
</div>
</div>
<p>Two categorical values: reason the student chose their school and the school they chose, are used to group descriptive statistics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Measures across two variables: reason for choosing school and the school that was chosen. </span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>MeasureAndSpread4 <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>combined <span class="sc">|&gt;</span> <span class="fu">group_by</span>(reason, school)<span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="fu">across</span>(age,<span class="at">.fns =</span> fxlist,<span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span>)),</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>combined <span class="sc">|&gt;</span> <span class="fu">group_by</span>(reason, school)<span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="fu">across</span>(absences.x,<span class="at">.fns =</span> fxlist,<span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span>)),</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>combined <span class="sc">|&gt;</span> <span class="fu">group_by</span>(reason, school)<span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="fu">across</span>(G3.x,<span class="at">.fns =</span> fxlist,<span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span>))</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'reason'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'reason'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'reason'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>MeasureAndSpread4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 8 × 7
# Groups:   reason [4]
  reason     school age_mean age_median age_var age_sd age_IQR
  &lt;chr&gt;      &lt;chr&gt;     &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1 course     GP         16.4         16   1.07   1.03     2   
2 course     MS         17.8         18   0.386  0.622    1   
3 home       GP         16.4         16   1.10   1.05     1   
4 home       MS         17.9         18   0.411  0.641    0.25
5 other      GP         16.4         16   2.35   1.53     1   
6 other      MS         18           18   0.286  0.535    0   
7 reputation GP         16.4         16   1.23   1.11     1   
8 reputation MS         17.4         17   0.3    0.548    1   

[[2]]
# A tibble: 8 × 7
# Groups:   reason [4]
  reason   school absences.x_mean absences.x_median absences.x_var absences.x_sd
  &lt;chr&gt;    &lt;chr&gt;            &lt;dbl&gt;             &lt;dbl&gt;          &lt;dbl&gt;         &lt;dbl&gt;
1 course   GP                4.41               2             25.1          5.01
2 course   MS                2.08               0             16.8          4.10
3 home     GP                7.24               4            140.          11.9 
4 home     MS                4.75               4             19.4          4.40
5 other    GP                6.09               5.5           25.0          5.00
6 other    MS                3                  2.5           11.7          3.42
7 reputat… GP                5.58               4             54.2          7.36
8 reputat… MS                5.2                2             51.7          7.19
# ℹ 1 more variable: absences.x_IQR &lt;dbl&gt;

[[3]]
# A tibble: 8 × 7
# Groups:   reason [4]
  reason     school G3.x_mean G3.x_median G3.x_var G3.x_sd G3.x_IQR
  &lt;chr&gt;      &lt;chr&gt;      &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
1 course     GP          10.4        11      21.8     4.67     4.75
2 course     MS          10.1        10      21.0     4.58     4   
3 home       GP          11.1        11      18.0     4.24     5   
4 home       MS          10.4        10       9.98    3.16     2.25
5 other      GP          12.1        12      13.8     3.71     5   
6 other      MS           9.5        10.5    18.6     4.31     3   
7 reputation GP          12.0        12      13.9     3.73     5   
8 reputation MS           9.2        10      48.7     6.98     5   </code></pre>
</div>
</div>
</section>
<section id="correlation-matrix" class="level1">
<h1>Correlation Matrix</h1>
<section id="correlation-matrix-of-three-target-variables" class="level2">
<h2 class="anchored" data-anchor-id="correlation-matrix-of-three-target-variables">correlation matrix of three target variables</h2>
<p>The correlation matrix below shows how three numeric variables: age, mathematics absences, and final mathematics assessment are correlated with each other. There are no particularly strong linear associations between the three variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>combined <span class="sc">|&gt;</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, absences.x, G3.x) <span class="sc">|&gt;</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  age  absences.x        G3.x
age         1.0000000  0.14392517 -0.20603186
absences.x  0.1439252  1.00000000 -0.02811847
G3.x       -0.2060319 -0.02811847  1.00000000</code></pre>
</div>
</div>
</section>
<section id="correlation-matrix-for-all-numeric-variables-in-combined-dataset" class="level2">
<h2 class="anchored" data-anchor-id="correlation-matrix-for-all-numeric-variables-in-combined-dataset">correlation matrix for all numeric variables in combined dataset</h2>
<p>For reference, a correlation matrix can easily be computed for all numeric variables in the dataset by taking advantage of the where(is.numeric) function. To properly interpret these some of these correlations prior knowledge is needed as some are discrete numerical values and others may be coded numeric values that represent categorical or ordinal data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>combined <span class="sc">|&gt;</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">|&gt;</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    age         Medu         Fedu   traveltime    studytime
age         1.000000000 -0.100949786 -0.107245313  0.160281754  0.043881028
Medu       -0.100949786  1.000000000  0.621523869 -0.218794954  0.045425978
Fedu       -0.107245313  0.621523869  1.000000000 -0.193978042 -0.039289626
traveltime  0.160281754 -0.218794954 -0.193978042  1.000000000 -0.103243249
studytime   0.043881028  0.045425978 -0.039289626 -0.103243249  1.000000000
failures    0.243429617 -0.125608045 -0.157496645  0.104521138 -0.179515785
famrel      0.049940980 -0.067657746 -0.047260992 -0.027275744  0.001381660
freetime   -0.045824466  0.004013326 -0.001258667 -0.055899592 -0.091829632
goout       0.150794790  0.065832096  0.050593936  0.006559725 -0.009403345
Dalc        0.113952023  0.062866542  0.039126588  0.161272613 -0.172278644
Walc        0.156817685 -0.004099434  0.023315814  0.105381347 -0.232402574
health     -0.113225976 -0.011497172  0.067152933  0.020869407 -0.040979063
absences.x  0.143925170  0.099832689  0.024617771 -0.001464243 -0.082387919
G1.x       -0.110379348  0.193071603  0.175557917 -0.088080745  0.125691378
G2.x       -0.186187399  0.188735230  0.150418214 -0.184594967  0.089030600
G3.x       -0.206031862  0.187754424  0.141990610 -0.165110961  0.045402243
absences.y  0.047331821  0.063530536  0.086614161  0.054308059 -0.134969383
G1.y       -0.050549678  0.181423706  0.115531025 -0.178191662  0.229739293
G2.y        0.029366456  0.189642017  0.136994424 -0.179611557  0.231059730
G3.y       -0.009103257  0.158979933  0.107807478 -0.153616466  0.238553746
              failures      famrel     freetime        goout        Dalc
age         0.24342962  0.04994098 -0.045824466  0.150794790  0.11395202
Medu       -0.12560804 -0.06765775  0.004013326  0.065832096  0.06286654
Fedu       -0.15749664 -0.04726099 -0.001258667  0.050593936  0.03912659
traveltime  0.10452114 -0.02727574 -0.055899592  0.006559725  0.16127261
studytime  -0.17951579  0.00138166 -0.091829632 -0.009403345 -0.17227864
failures    1.00000000  0.09437401  0.089757964  0.097119445  0.16213974
famrel      0.09437401  1.00000000  0.090946059  0.033058834 -0.05737989
freetime    0.08975796  0.09094606  1.000000000  0.243271162  0.20497133
goout       0.09711944  0.03305883  0.243271162  1.000000000  0.25703214
Dalc        0.16213974 -0.05737989  0.204971335  0.257032140  1.00000000
Walc        0.16736348 -0.12634267  0.119021094  0.378591514  0.64989386
health      0.04225577  0.13959656  0.070864701 -0.049000564  0.05996329
absences.x  0.12006863 -0.04806901 -0.046300383  0.078848996  0.15159884
G1.x       -0.19581035 -0.05618075 -0.017100766 -0.115882796 -0.09641793
G2.x       -0.16669179 -0.08710139 -0.029677027 -0.158978350 -0.05916707
G3.x       -0.14303203 -0.01797570 -0.006516202 -0.118423233 -0.04696434
absences.y  0.13424264 -0.02955203 -0.011429255  0.128521823  0.10753855
G1.y       -0.26927657 -0.06419546 -0.085629896 -0.071905764 -0.23398211
G2.y       -0.26992597 -0.02441686 -0.087231866 -0.091151551 -0.25300707
G3.y       -0.32775690 -0.01282948 -0.110638817 -0.073423265 -0.27992305
                   Walc       health   absences.x        G1.x        G2.x
age         0.156817685 -0.113225976  0.143925170 -0.11037935 -0.18618740
Medu       -0.004099434 -0.011497172  0.099832689  0.19307160  0.18873523
Fedu        0.023315814  0.067152933  0.024617771  0.17555792  0.15041821
traveltime  0.105381347  0.020869407 -0.001464243 -0.08808075 -0.18459497
studytime  -0.232402574 -0.040979063 -0.082387919  0.12569138  0.08903060
failures    0.167363479  0.042255769  0.120068630 -0.19581035 -0.16669179
famrel     -0.126342672  0.139596565 -0.048069014 -0.05618075 -0.08710139
freetime    0.119021094  0.070864701 -0.046300383 -0.01710077 -0.02967703
goout       0.378591514 -0.049000564  0.078848996 -0.11588280 -0.15897835
Dalc        0.649893859  0.059963287  0.151598836 -0.09641793 -0.05916707
Walc        1.000000000  0.070450703  0.208026186 -0.07964360 -0.06540510
health      0.070450703  1.000000000  0.012122515 -0.06155381 -0.07666718
absences.x  0.208026186  0.012122515  1.000000000 -0.06946116 -0.07580245
G1.x       -0.079643599 -0.061553810 -0.069461164  1.00000000  0.86588796
G2.x       -0.065405098 -0.076667185 -0.075802450  0.86588796  1.00000000
G3.x       -0.027623053 -0.047513775 -0.028118470  0.81859418  0.91357599
absences.y  0.150366322 -0.001077612  0.563815592 -0.08760610 -0.12636236
G1.y       -0.158160549 -0.126244006 -0.092477610  0.59293522  0.54300736
G2.y       -0.183295800 -0.170419288 -0.145164017  0.59517224  0.56521350
G3.y       -0.182606733 -0.162249671 -0.135726385  0.54388734  0.49603265
                   G3.x   absences.y        G1.y        G2.y         G3.y
age        -0.206031862  0.047331821 -0.05054968  0.02936646 -0.009103257
Medu        0.187754424  0.063530536  0.18142371  0.18964202  0.158979933
Fedu        0.141990610  0.086614161  0.11553102  0.13699442  0.107807478
traveltime -0.165110961  0.054308059 -0.17819166 -0.17961156 -0.153616466
studytime   0.045402243 -0.134969383  0.22973929  0.23105973  0.238553746
failures   -0.143032028  0.134242644 -0.26927657 -0.26992597 -0.327756897
famrel     -0.017975700 -0.029552034 -0.06419546 -0.02441686 -0.012829483
freetime   -0.006516202 -0.011429255 -0.08562990 -0.08723187 -0.110638817
goout      -0.118423233  0.128521823 -0.07190576 -0.09115155 -0.073423265
Dalc       -0.046964337  0.107538550 -0.23398211 -0.25300707 -0.279923052
Walc       -0.027623053  0.150366322 -0.15816055 -0.18329580 -0.182606733
health     -0.047513775 -0.001077612 -0.12624401 -0.17041929 -0.162249671
absences.x -0.028118470  0.563815592 -0.09247761 -0.14516402 -0.135726385
G1.x        0.818594184 -0.087606100  0.59293522  0.59517224  0.543887345
G2.x        0.913575991 -0.126362360  0.54300736  0.56521350  0.496032649
G3.x        1.000000000 -0.116640460  0.52288461  0.54545279  0.475956497
absences.y -0.116640460  1.000000000 -0.09864117 -0.12070727 -0.071452010
G1.y        0.522884610 -0.098641173  1.00000000  0.88415041  0.825414320
G2.y        0.545452789 -0.120707273  0.88415041  1.00000000  0.894309821
G3.y        0.475956497 -0.071452010  0.82541432  0.89430982  1.000000000</code></pre>
</div>
</div>
</section>
</section>
<section id="hist.-density-boxplot" class="level1">
<h1>Hist., Density, Boxplot</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using technique of naming ggplot object and calling in later steps</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co">#g &lt;- ggplot(combined, aes(x = absences.x, fill = sex))</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co">#g + geom_histogram( bins = 10, position = "dodge") + </span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>   <span class="co"># geom_density(alpha = .4) + </span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co">#    labs(x = "Math Absences")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="scatterplot-analyses" class="level1">
<h1>Scatterplot Analyses</h1>
<section id="scatterplot-1-math-g3-scores-by-math-absences-by-school" class="level2">
<h2 class="anchored" data-anchor-id="scatterplot-1-math-g3-scores-by-math-absences-by-school">Scatterplot 1 Math G3 Scores by Math Absences by school</h2>
<p>In the scatterplot below, each dot represents a student’s unique combination of school they attend, mathematics absences and math G3 score. What school they attended is noted by their dot color.</p>
<p>Most students had below 20 absences, and those with more tended to score worse on the assessment. Students in the MS school had fewer absences as a group than those in the GP school and they account for none of the outliers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(combined, <span class="fu">aes</span>(<span class="at">x =</span> absences.x, <span class="at">y =</span> G3.x, <span class="at">color =</span> school))</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>gs <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Math Absences"</span>, <span class="at">y =</span> <span class="st">"Math G3 Score"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="homework5_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="scatterplot-2-math-g3-scores-by-math-g1-scores-by-sex" class="level2">
<h2 class="anchored" data-anchor-id="scatterplot-2-math-g3-scores-by-math-g1-scores-by-sex">Scatterplot 2 Math G3 Scores by Math G1 Scores by Sex</h2>
<p>This scatterplot shows a strong linear relationship between the mathematics G1 score and the mathematics G3 score. Dot color denotes sex. The relationship appears consistent across sex.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>gs2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(combined, <span class="fu">aes</span>(<span class="at">x =</span> G1.x, <span class="at">y =</span> G3.x, <span class="at">color =</span> sex))</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>gs2 <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Math G1 Score"</span>, <span class="at">y =</span> <span class="st">"Math G3 Score"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="homework5_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="scatterplot-2-math-g3-scores-by-math-g1-scores-by-sex-1" class="level2">
<h2 class="anchored" data-anchor-id="scatterplot-2-math-g3-scores-by-math-g1-scores-by-sex-1">Scatterplot 2 Math G3 Scores by Math G1 Scores by Sex</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>gs2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(combined, <span class="fu">aes</span>(<span class="at">x =</span> G1.x, <span class="at">y =</span> G3.x, <span class="at">color =</span> sex))</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>gs2 <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Math G1 Score"</span>, <span class="at">y =</span> <span class="st">"Math G3 Score"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="homework5_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="scatterplot-with-facet" class="level2">
<h2 class="anchored" data-anchor-id="scatterplot-with-facet">Scatterplot with facet</h2>
<p>This plot shows a different presentation of the above information. Instead of each dot being a distinct color - males and females have their own scatterplot side by side. The male scores appear slightly more widely dispersed than the female scores.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>gs2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(combined, <span class="fu">aes</span>(<span class="at">x =</span> G1.x, <span class="at">y =</span> G3.x))</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>gs2 <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Math G1 Score"</span>, <span class="at">y =</span> <span class="st">"Math G3 Score"</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>sex) <span class="sc">+</span> <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="homework5_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="scatterplot-with-multi-categorical-facet" class="level2">
<h2 class="anchored" data-anchor-id="scatterplot-with-multi-categorical-facet">Scatterplot with multi categorical facet</h2>
<p>More than one categorical value can be used to research the G1 to G3 relationship. The 2x2 plot below shows this relationship by sex and by school. The same positive linear relationship is seen across all quadrants though the GP school has many more data points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>gs3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(combined, <span class="fu">aes</span>(<span class="at">x =</span> G1.x, <span class="at">y =</span> G3.x))</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>gs3 <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Math G1 Score"</span>, <span class="at">y =</span> <span class="st">"Math G3 Score"</span>) <span class="sc">+</span> </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(school), <span class="at">cols =</span> <span class="fu">vars</span>(sex))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="homework5_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>