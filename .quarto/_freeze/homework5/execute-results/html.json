{
  "hash": "a155f3fb41a61980297f389794c12a6c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"homework5\"\nformat: html\neditor: visual\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'tidyverse' was built under R version 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'ggplot2' was built under R version 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'tidyr' was built under R version 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'readr' was built under R version 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'dplyr' was built under R version 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'stringr' was built under R version 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'forcats' was built under R version 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'lubridate' was built under R version 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   4.0.0     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(psych)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'psych' was built under R version 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'psych'\n\nThe following objects are masked from 'package:ggplot2':\n\n    %+%, alpha\n```\n\n\n:::\n:::\n\n\n\n# Read in UCI Data\n\nInitially read in data using provided code including the merge-join based on original 13 variables.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#use r code provided in download... already suitable to read files from project folder\nd1=read.table(\"student-mat.csv\",sep=\";\",header=TRUE)\nd2=read.table(\"student-por.csv\",sep=\";\",header=TRUE)\n\nd3=merge(d1,d2,by=c(\"school\",\"sex\",\"age\",\"address\",\"famsize\",\"Pstatus\",\"Medu\",\"Fedu\",\"Mjob\",\"Fjob\",\"reason\",\"nursery\",\"internet\"))\n#print(nrow(d3)) # 382 students\n```\n:::\n\n\n\n# Tidyverse Read in Data\n\nUse tidyverse functions to read in data and use original 13 suggested variables as inner join criteria. This leads to a many:many relationship which suggests the 13 field combinations are not specific enough.\n\n-   The Mat dataset shows student demographic information and test scores from a mathematics class. This is the \"LEFT\" dataset in the join and data elements exclusive to it end in \".x\"\n\n-   The Por dataset shows student demographic information and test scores from a Portuguese class. This is the \"RIGHT\" dataset in the join and data elements exclusive to it end in \".y\"\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#same work done using tidyverse functions\nmat <- as_tibble(read_delim(\"student-mat.csv\", delim = \";\", col_names = TRUE))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 395 Columns: 33\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \";\"\nchr (17): school, sex, address, famsize, Pstatus, Mjob, Fjob, reason, guardi...\ndbl (16): age, Medu, Fedu, traveltime, studytime, failures, famrel, freetime...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\npor <- as_tibble(read_delim(\"student-por.csv\", delim = \";\", col_names = TRUE))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 649 Columns: 33\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \";\"\nchr (17): school, sex, address, famsize, Pstatus, Mjob, Fjob, reason, guardi...\ndbl (16): age, Medu, Fedu, traveltime, studytime, failures, famrel, freetime...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\n#result is many:many join - these fields are not specific enough\nInitialJoin <- inner_join(mat, por, by = join_by(\"school\",\"sex\",\"age\",\"address\",\"famsize\",\"Pstatus\",\"Medu\",\"Fedu\",\"Mjob\",\"Fjob\",\"reason\",\"nursery\",\"internet\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in inner_join(mat, por, by = join_by(\"school\", \"sex\", \"age\", \"address\", : Detected an unexpected many-to-many relationship between `x` and `y`.\nℹ Row 79 of `x` matches multiple rows in `y`.\nℹ Row 79 of `y` matches multiple rows in `x`.\nℹ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.\n```\n\n\n:::\n:::\n\n\n\n# Assign factors for categorical variables of interest\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmat <-  mat |>\n  mutate(\n    health_f = factor(health,levels = c(seq(1:5)),\n                     labels = c(\"very bad\",\"bad\",\"neutral\",\"good\",\"very good\")),\n    Walc_f = factor(Walc,levels = c(seq(1:5)),\n                    labels = c(\"very low\", \"low\", \"0-avg\",\"high\",\"very high\")),\n    Dalc_f = factor(Dalc,levels = c(seq(1:5)),\n                    labels = c(\"very low\", \"low\", \"0-avg\",\"high\",\"very high\")),\n    studytime_f = factor(studytime,levels = c(seq(1:4)),\n                    labels = c(\"<2 hours\", \"2-5 hours\", \"5-10 hours\",\">10 hours\")),\n    sex_f = factor(sex,levels = c(\"M\",\"F\"),\n                    labels = c(\"Male\",\"Female\")),\n    school_f = factor(school,levels = c(\"GP\",\"MS\"),\n                    labels = c(\"Gabriel Pereira\",\"Mousinho da Silveira\")),\n    address_f = factor(address,levels = c(\"R\",\"U\"),\n                    labels = c(\"Rural\",\"Urban\"))\n  )\n\npor <-  por |>\n  mutate(\n    health_f = factor(health,levels = c(seq(1:5)),\n                     labels = c(\"very bad\",\"bad\",\"neutral\",\"good\",\"very good\")),\n    Walc_f = factor(Walc,levels = c(seq(1:5)),\n                    labels = c(\"very low\", \"low\", \"0-avg\",\"high\",\"very high\")),\n    Dalc_f = factor(Dalc,levels = c(seq(1:5)),\n                    labels = c(\"very low\", \"low\", \"0-avg\",\"high\",\"very high\")),\n    studytime_f = factor(studytime,levels = c(seq(1:4)),\n                    labels = c(\"<2 hours\", \"2-5 hours\", \"5-10 hours\",\">10 hours\")),\n    sex_f = factor(sex,levels = c(\"M\",\"F\"),\n                    labels = c(\"Male\",\"Female\")),\n    school_f = factor(school,levels = c(\"GP\",\"MS\"),\n                    labels = c(\"Gabriel Pereira\",\"Mousinho da Silveira\")),\n    address_f = factor(address,levels = c(\"R\",\"U\"),\n                    labels = c(\"Rural\",\"Urban\"))\n  )\n```\n:::\n\n\n\n# Final Join\n\nThis inner join uses all variables EXCEPT G1, G2, G3, paid and absences. The four factor variables are also excluded as join criteria.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#join by every field except response variables\n#no many:many join message\ncombined <- as_tibble(\n  inner_join(mat, por, \n             by = names(select(mat,everything(), -c(\"G1\",\"G2\",\"G3\",\"paid\",\"absences\", \"health_f\", \"Walc_f\", \"Dalc_f\", \"studytime_f\",\"sex_f\", \"school_f\", \"address_f\")))\n             )\n  )\n\n#clear initial imports out of environment\nrm(d1,d2,d3,InitialJoin)\n```\n:::\n\n\n\n# Initial EDA\n\nThese analyses demonstrate:\n\n1.  The full combined dataset.\n2.  Descriptive statistics for all dataset variables. Some of the variables are coded in such a way that many statistics such as the \"address\" field having a numeric mean.\n3.  Two methods are used to find missing data values - there are no missing values for any variable in the dataset.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#view tibble - observe sample of values\ncombined\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 320 × 52\n   school sex     age address famsize Pstatus  Medu  Fedu Mjob     Fjob   reason\n   <chr>  <chr> <dbl> <chr>   <chr>   <chr>   <dbl> <dbl> <chr>    <chr>  <chr> \n 1 GP     F        18 U       GT3     A           4     4 at_home  teach… course\n 2 GP     F        17 U       GT3     T           1     1 at_home  other  course\n 3 GP     F        15 U       GT3     T           4     2 health   servi… home  \n 4 GP     F        16 U       GT3     T           3     3 other    other  home  \n 5 GP     M        16 U       LE3     T           4     3 services other  reput…\n 6 GP     M        16 U       LE3     T           2     2 other    other  home  \n 7 GP     F        17 U       GT3     A           4     4 other    teach… home  \n 8 GP     M        15 U       LE3     A           3     2 services other  home  \n 9 GP     M        15 U       GT3     T           3     4 other    other  home  \n10 GP     F        15 U       GT3     T           4     4 teacher  health reput…\n# ℹ 310 more rows\n# ℹ 41 more variables: guardian <chr>, traveltime <dbl>, studytime <dbl>,\n#   failures <dbl>, schoolsup <chr>, famsup <chr>, paid.x <chr>,\n#   activities <chr>, nursery <chr>, higher <chr>, internet <chr>,\n#   romantic <chr>, famrel <dbl>, freetime <dbl>, goout <dbl>, Dalc <dbl>,\n#   Walc <dbl>, health <dbl>, absences.x <dbl>, G1.x <dbl>, G2.x <dbl>,\n#   G3.x <dbl>, health_f.x <fct>, Walc_f.x <fct>, Dalc_f.x <fct>, …\n```\n\n\n:::\n\n```{.r .cell-code}\n#use describe() to get descriptive statistics on all variables\npsych::describe(combined)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              vars   n  mean   sd median trimmed  mad min max range  skew\nschool           1 320  1.10 0.30    1.0    1.00 0.00   1   2     1  2.60\nsex              2 320  1.46 0.50    1.0    1.45 0.00   1   2     1  0.17\nage              3 320 16.52 1.14   16.0   16.49 1.48  15  22     7  0.43\naddress          4 320  1.79 0.41    2.0    1.86 0.00   1   2     1 -1.42\nfamsize          5 320  1.28 0.45    1.0    1.23 0.00   1   2     1  0.97\nPstatus          6 320  1.90 0.30    2.0    2.00 0.00   1   2     1 -2.71\nMedu             7 320  2.87 1.07    3.0    2.97 1.48   0   4     4 -0.43\nFedu             8 320  2.62 1.09    3.0    2.66 1.48   0   4     4 -0.16\nMjob             9 320  3.21 1.24    3.0    3.26 1.48   1   5     4 -0.29\nFjob            10 320  3.31 0.86    3.0    3.32 0.00   1   5     4 -0.25\nreason          11 320  2.26 1.21    2.0    2.20 1.48   1   4     3  0.40\nguardian        12 320  1.80 0.47    2.0    1.84 0.00   1   3     2 -0.60\ntraveltime      13 320  1.43 0.69    1.0    1.29 0.00   1   4     3  1.65\nstudytime       14 320  2.08 0.87    2.0    2.00 1.48   1   4     3  0.59\nfailures        15 320  0.08 0.39    0.0    0.00 0.00   0   3     3  5.92\nschoolsup       16 320  1.13 0.34    1.0    1.04 0.00   1   2     1  2.13\nfamsup          17 320  1.63 0.48    2.0    1.67 0.00   1   2     1 -0.56\npaid.x          18 320  1.50 0.50    1.5    1.50 0.74   1   2     1  0.00\nactivities      19 320  1.53 0.50    2.0    1.54 0.00   1   2     1 -0.12\nnursery         20 320  1.82 0.39    2.0    1.89 0.00   1   2     1 -1.62\nhigher          21 320  1.98 0.15    2.0    2.00 0.00   1   2     1 -6.51\ninternet        22 320  1.85 0.36    2.0    1.94 0.00   1   2     1 -1.95\nromantic        23 320  1.31 0.46    1.0    1.26 0.00   1   2     1  0.82\nfamrel          24 320  3.99 0.89    4.0    4.08 1.48   1   5     4 -0.98\nfreetime        25 320  3.20 0.97    3.0    3.20 1.48   1   5     4 -0.14\ngoout           26 320  3.07 1.10    3.0    3.04 1.48   1   5     4  0.16\nDalc            27 320  1.44 0.88    1.0    1.21 0.00   1   5     4  2.34\nWalc            28 320  2.22 1.26    2.0    2.08 1.48   1   5     4  0.68\nhealth          29 320  3.52 1.42    4.0    3.65 1.48   1   5     4 -0.49\nabsences.x      30 320  5.41 7.84    4.0    4.00 5.93   0  75    75  4.25\nG1.x            31 320 11.29 3.20   11.0   11.19 2.97   5  19    14  0.27\nG2.x            32 320 11.18 3.67   11.0   11.29 2.97   0  19    19 -0.45\nG3.x            33 320 11.04 4.30   11.0   11.38 4.45   0  20    20 -0.76\nhealth_f.x      34 320  3.52 1.42    4.0    3.65 1.48   1   5     4 -0.49\nWalc_f.x        35 320  2.22 1.26    2.0    2.08 1.48   1   5     4  0.68\nDalc_f.x        36 320  1.44 0.88    1.0    1.21 0.00   1   5     4  2.34\nstudytime_f.x   37 320  2.08 0.87    2.0    2.00 1.48   1   4     3  0.59\nsex_f.x         38 320  1.54 0.50    2.0    1.55 0.00   1   2     1 -0.17\nschool_f.x      39 320  1.10 0.30    1.0    1.00 0.00   1   2     1  2.60\naddress_f.x     40 320  1.79 0.41    2.0    1.86 0.00   1   2     1 -1.42\npaid.y          41 320  1.06 0.24    1.0    1.00 0.00   1   2     1  3.60\nabsences.y      42 320  3.25 4.56    2.0    2.33 2.97   0  32    32  2.53\nG1.y            43 320 12.39 2.56   12.0   12.41 2.97   0  19    19 -0.31\nG2.y            44 320 12.57 2.42   12.0   12.52 2.97   5  19    14  0.20\nG3.y            45 320 12.88 2.89   13.0   12.97 2.97   0  19    19 -1.13\nhealth_f.y      46 320  3.52 1.42    4.0    3.65 1.48   1   5     4 -0.49\nWalc_f.y        47 320  2.22 1.26    2.0    2.08 1.48   1   5     4  0.68\nDalc_f.y        48 320  1.44 0.88    1.0    1.21 0.00   1   5     4  2.34\nstudytime_f.y   49 320  2.08 0.87    2.0    2.00 1.48   1   4     3  0.59\nsex_f.y         50 320  1.54 0.50    2.0    1.55 0.00   1   2     1 -0.17\nschool_f.y      51 320  1.10 0.30    1.0    1.00 0.00   1   2     1  2.60\naddress_f.y     52 320  1.79 0.41    2.0    1.86 0.00   1   2     1 -1.42\n              kurtosis   se\nschool            4.76 0.02\nsex              -1.98 0.03\nage               0.35 0.06\naddress           0.02 0.02\nfamsize          -1.07 0.03\nPstatus           5.38 0.02\nMedu             -1.03 0.06\nFedu             -1.16 0.06\nMjob             -0.71 0.07\nFjob              0.90 0.05\nreason           -1.41 0.07\nguardian          0.21 0.03\ntraveltime        2.46 0.04\nstudytime        -0.20 0.05\nfailures         38.64 0.02\nschoolsup         2.56 0.02\nfamsup           -1.70 0.03\npaid.x           -2.01 0.03\nactivities       -1.99 0.03\nnursery           0.63 0.02\nhigher           40.46 0.01\ninternet          1.81 0.02\nromantic         -1.33 0.03\nfamrel            1.21 0.05\nfreetime         -0.27 0.05\ngoout            -0.73 0.06\nDalc              5.32 0.05\nWalc             -0.69 0.07\nhealth           -1.07 0.08\nabsences.x       27.83 0.44\nG1.x             -0.70 0.18\nG2.x              0.62 0.21\nG3.x              0.75 0.24\nhealth_f.x       -1.07 0.08\nWalc_f.x         -0.69 0.07\nDalc_f.x          5.32 0.05\nstudytime_f.x    -0.20 0.05\nsex_f.x          -1.98 0.03\nschool_f.x        4.76 0.02\naddress_f.x       0.02 0.02\npaid.y           10.98 0.01\nabsences.y        9.37 0.25\nG1.y              1.08 0.14\nG2.y             -0.19 0.14\nG3.y              4.18 0.16\nhealth_f.y       -1.07 0.08\nWalc_f.y         -0.69 0.07\nDalc_f.y          5.32 0.05\nstudytime_f.y    -0.20 0.05\nsex_f.y          -1.98 0.03\nschool_f.y        4.76 0.02\naddress_f.y       0.02 0.02\n```\n\n\n:::\n\n```{.r .cell-code}\n#determine missing rate using function in lecture\n##no missing values identified throughout entire dataset\ncolSums(is.na(combined))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       school           sex           age       address       famsize \n            0             0             0             0             0 \n      Pstatus          Medu          Fedu          Mjob          Fjob \n            0             0             0             0             0 \n       reason      guardian    traveltime     studytime      failures \n            0             0             0             0             0 \n    schoolsup        famsup        paid.x    activities       nursery \n            0             0             0             0             0 \n       higher      internet      romantic        famrel      freetime \n            0             0             0             0             0 \n        goout          Dalc          Walc        health    absences.x \n            0             0             0             0             0 \n         G1.x          G2.x          G3.x    health_f.x      Walc_f.x \n            0             0             0             0             0 \n     Dalc_f.x studytime_f.x       sex_f.x    school_f.x   address_f.x \n            0             0             0             0             0 \n       paid.y    absences.y          G1.y          G2.y          G3.y \n            0             0             0             0             0 \n   health_f.y      Walc_f.y      Dalc_f.y studytime_f.y       sex_f.y \n            0             0             0             0             0 \n   school_f.y   address_f.y \n            0             0 \n```\n\n\n:::\n\n```{.r .cell-code}\nsum_na <- function(column){\n  sum(is.na(column))\n}\n\nna_counts <- combined |>\n  summarize(across(everything(), sum_na))\nna_counts\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 52\n  school   sex   age address famsize Pstatus  Medu  Fedu  Mjob  Fjob reason\n   <int> <int> <int>   <int>   <int>   <int> <int> <int> <int> <int>  <int>\n1      0     0     0       0       0       0     0     0     0     0      0\n# ℹ 41 more variables: guardian <int>, traveltime <int>, studytime <int>,\n#   failures <int>, schoolsup <int>, famsup <int>, paid.x <int>,\n#   activities <int>, nursery <int>, higher <int>, internet <int>,\n#   romantic <int>, famrel <int>, freetime <int>, goout <int>, Dalc <int>,\n#   Walc <int>, health <int>, absences.x <int>, G1.x <int>, G2.x <int>,\n#   G3.x <int>, health_f.x <int>, Walc_f.x <int>, Dalc_f.x <int>,\n#   studytime_f.x <int>, sex_f.x <int>, school_f.x <int>, address_f.x <int>, …\n```\n\n\n:::\n:::\n\n\n\n# Contingency Tables\n\n## Simple one way contingency\n\nThis one way contingency table shows the number of students residing in each address type (R= Rural / U=Urban)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#one way contingency table\ntable(combined$address_f.x)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nRural Urban \n   67   253 \n```\n\n\n:::\n:::\n\n\n\n## Two way and three way contingency\n\nBelow are a two way and a three way contingency table. The two way shows the mother's job by address type. The three way contingency table shows the first two way contingency table with its values split by a 3rd dimension the presence of family educational support (yes/no).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#two way contingency table \ntable(combined$Mjob, combined$address_f.x)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          \n           Rural Urban\n  at_home     18    26\n  health       3    27\n  other       23    93\n  services    12    63\n  teacher     11    44\n```\n\n\n:::\n\n```{.r .cell-code}\n#three way contingency table\ntable(combined$Mjob, combined$address_f.x, combined$famsup)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n, ,  = no\n\n          \n           Rural Urban\n  at_home      7    10\n  health       1     6\n  other       11    41\n  services     2    22\n  teacher      4    13\n\n, ,  = yes\n\n          \n           Rural Urban\n  at_home     11    16\n  health       2    21\n  other       12    52\n  services    10    41\n  teacher      7    31\n```\n\n\n:::\n:::\n\n\n\n## Conditional two way table\n\nThese two contingency tables demonstrate multiple ways to subset contingency table data - the first uses a filter function, and the second filters based on the 2nd item of the 3rd array dimension. Both methods return identical data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#conditional two way table - observe study time by sex where address is rural \n#create data subset before table()\nruraldata <- combined |> \n  filter(address == \"U\") \ntable(ruraldata$sex_f.x, ruraldata$studytime_f.x)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        \n         <2 hours 2-5 hours 5-10 hours >10 hours\n  Male         41        54         10         9\n  Female       18        78         32        11\n```\n\n\n:::\n\n```{.r .cell-code}\n#conditional two way table - observe study time by sex where address is urban\ntwoway_2 <- table(combined$sex_f.x, combined$studytime_f.x, combined$address_f.x)\ntwoway_2[,,2] #selecting for urban [sex row, study time column,rural/urban]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        \n         <2 hours 2-5 hours 5-10 hours >10 hours\n  Male         41        54         10         9\n  Female       18        78         32        11\n```\n\n\n:::\n:::\n\n\n\n## dplyr contingency table\n\nDplyr group_by and summarize functions are used to create counts by weekly alcohol use and health status. This original structure included a row for each combination of the two categorical variables. Pivot wider creates new columns from repeating values from an existing column - Walc_f.x.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#observe count of health status across levels of reported weekly alcohol use\n#reorient data using pivot_wider()\ncombined |>\n  group_by(health_f.x, Walc_f.x) |>\n  summarize(count = n()) |>\n  pivot_wider(names_from = health_f.x, values_from = count)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'health_f.x'. You can override using the\n`.groups` argument.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 6\n  Walc_f.x  `very bad`   bad neutral  good `very good`\n  <fct>          <int> <int>   <int> <int>       <int>\n1 very low          19    12      31    25          41\n2 low               10     6      18     9          28\n3 0-avg              9    11      11    12          19\n4 high               4     4       5     4          22\n5 very high          2     1       5     5           7\n```\n\n\n:::\n:::\n\n\n\n# Initial Bar Plots\n\n## Compare stacked with side by side\n\nTwo simple bar plots were created to demonstrate the different ways multiple categorical variables can be shown in a bar plot. One shows the total counts for the two groups stacked on top of each other. The other shows the two groups side-by-side, which can be easier to quickly read and interpret.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#stacked bar plot\nggplot(combined, aes(x = health_f.x, fill = address_f.x)) +\n  geom_bar() +\n  labs(title = \"Stacked Bar Chart\",x = \"Health\", y = \"Observations\") +\n  theme_light()\n```\n\n::: {.cell-output-display}\n![](homework5_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#side by side bar plot\nggplot(combined, aes(x = health_f.x, fill = address_f.x)) +\n  geom_bar(position = \"dodge\") +\n  labs(title = \"Side by Side Bar Chart\", x = \"Health\", y = \"Observations\") + \n  theme_light()\n```\n\n::: {.cell-output-display}\n![](homework5_files/figure-html/unnamed-chunk-11-2.png){width=672}\n:::\n:::\n\n\n\n# Numeric Variables\n\n5 measures of center and spread: mean, median, variance, standard deviation, and interquartile range were used to describe three numeric variables (student age, mathematics class absences, and the final G3 mathematics assessment score.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Measures of Center and Spread\nfxlist <- list(\"mean\" = mean, \"median\" = median, \"var\" = var, \"sd\" = sd, \"IQR\" = IQR)\n\nMeasureAndSpread1 <- list(\ncombined |> summarize(across(age,.fns = fxlist,.names = \"{.col}_{.fn}\")),\ncombined |> summarize(across(absences.x,.fns = fxlist,.names = \"{.col}_{.fn}\")),\ncombined |> summarize(across(G3.x,.fns = fxlist,.names = \"{.col}_{.fn}\"))\n)\n\nMeasureAndSpread1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[[1]]\n# A tibble: 1 × 5\n  age_mean age_median age_var age_sd age_IQR\n     <dbl>      <dbl>   <dbl>  <dbl>   <dbl>\n1     16.5         16    1.30   1.14       1\n\n[[2]]\n# A tibble: 1 × 5\n  absences.x_mean absences.x_median absences.x_var absences.x_sd absences.x_IQR\n            <dbl>             <dbl>          <dbl>         <dbl>          <dbl>\n1            5.41                 4           61.4          7.84           7.25\n\n[[3]]\n# A tibble: 1 × 5\n  G3.x_mean G3.x_median G3.x_var G3.x_sd G3.x_IQR\n      <dbl>       <dbl>    <dbl>   <dbl>    <dbl>\n1      11.0          11     18.5    4.30        5\n```\n\n\n:::\n:::\n\n\n\nThe tables below take a similar approach to the first but have added a grouping variable, school. This helps one understand differences in students across the schools.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Overall age absences and G3 across school\n\n\nMeasureAndSpread2 <- list(\ncombined |> group_by(school_f.x)|> summarize(across(age,.fns = fxlist,.names = \"{.col}_{.fn}\")),\ncombined |> group_by(school_f.x)|> summarize(across(absences.x,.fns = fxlist,.names = \"{.col}_{.fn}\")),\ncombined |> group_by(school_f.x)|> summarize(across(G3.x,.fns = fxlist,.names = \"{.col}_{.fn}\")))\n\nMeasureAndSpread2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[[1]]\n# A tibble: 2 × 6\n  school_f.x           age_mean age_median age_var age_sd age_IQR\n  <fct>                   <dbl>      <dbl>   <dbl>  <dbl>   <dbl>\n1 Gabriel Pereira          16.4         16   1.21   1.10        1\n2 Mousinho da Silveira     17.8         18   0.360  0.600       1\n\n[[2]]\n# A tibble: 2 × 6\n  school_f.x      absences.x_mean absences.x_median absences.x_var absences.x_sd\n  <fct>                     <dbl>             <dbl>          <dbl>         <dbl>\n1 Gabriel Pereira            5.64                 4           65.7          8.10\n2 Mousinho da Si…            3.42                 2           20.7          4.55\n# ℹ 1 more variable: absences.x_IQR <dbl>\n\n[[3]]\n# A tibble: 2 × 6\n  school_f.x           G3.x_mean G3.x_median G3.x_var G3.x_sd G3.x_IQR\n  <fct>                    <dbl>       <dbl>    <dbl>   <dbl>    <dbl>\n1 Gabriel Pereira          11.2           11     18.3    4.27        5\n2 Mousinho da Silveira      9.88          10     19.7    4.44        4\n```\n\n\n:::\n:::\n\n\n\nBelow the same information is repeated with a subset for the GP school.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#subset for GP school\ncombinedgp <- filter(combined,school == \"GP\")\nMeasureAndSpread3 <- list(\ncombinedgp |> summarize(across(age,.fns = fxlist,.names = \"{.col}_{.fn}\")),\ncombinedgp |> summarize(across(absences.x,.fns = fxlist,.names = \"{.col}_{.fn}\")),\ncombinedgp |> summarize(across(G3.x,.fns = fxlist,.names = \"{.col}_{.fn}\"))\n)\n\nMeasureAndSpread3\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[[1]]\n# A tibble: 1 × 5\n  age_mean age_median age_var age_sd age_IQR\n     <dbl>      <dbl>   <dbl>  <dbl>   <dbl>\n1     16.4         16    1.21   1.10       1\n\n[[2]]\n# A tibble: 1 × 5\n  absences.x_mean absences.x_median absences.x_var absences.x_sd absences.x_IQR\n            <dbl>             <dbl>          <dbl>         <dbl>          <dbl>\n1            5.64                 4           65.7          8.10              8\n\n[[3]]\n# A tibble: 1 × 5\n  G3.x_mean G3.x_median G3.x_var G3.x_sd G3.x_IQR\n      <dbl>       <dbl>    <dbl>   <dbl>    <dbl>\n1      11.2          11     18.3    4.27        5\n```\n\n\n:::\n:::\n\n\n\nTwo categorical values: reason the student chose their school and the school they chose, are used to group descriptive statistics.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Measures across two variables: reason for choosing school and the school that was chosen. \nMeasureAndSpread4 <- list(\ncombined |> group_by(reason, school)|> summarize(across(age,.fns = fxlist,.names = \"{.col}_{.fn}\")),\ncombined |> group_by(reason, school)|> summarize(across(absences.x,.fns = fxlist,.names = \"{.col}_{.fn}\")),\ncombined |> group_by(reason, school)|> summarize(across(G3.x,.fns = fxlist,.names = \"{.col}_{.fn}\"))\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'reason'. You can override using the\n`.groups` argument.\n`summarise()` has grouped output by 'reason'. You can override using the\n`.groups` argument.\n`summarise()` has grouped output by 'reason'. You can override using the\n`.groups` argument.\n```\n\n\n:::\n\n```{.r .cell-code}\nMeasureAndSpread4\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[[1]]\n# A tibble: 8 × 7\n# Groups:   reason [4]\n  reason     school age_mean age_median age_var age_sd age_IQR\n  <chr>      <chr>     <dbl>      <dbl>   <dbl>  <dbl>   <dbl>\n1 course     GP         16.4         16   1.07   1.03     2   \n2 course     MS         17.8         18   0.386  0.622    1   \n3 home       GP         16.4         16   1.10   1.05     1   \n4 home       MS         17.9         18   0.411  0.641    0.25\n5 other      GP         16.4         16   2.35   1.53     1   \n6 other      MS         18           18   0.286  0.535    0   \n7 reputation GP         16.4         16   1.23   1.11     1   \n8 reputation MS         17.4         17   0.3    0.548    1   \n\n[[2]]\n# A tibble: 8 × 7\n# Groups:   reason [4]\n  reason   school absences.x_mean absences.x_median absences.x_var absences.x_sd\n  <chr>    <chr>            <dbl>             <dbl>          <dbl>         <dbl>\n1 course   GP                4.41               2             25.1          5.01\n2 course   MS                2.08               0             16.8          4.10\n3 home     GP                7.24               4            140.          11.9 \n4 home     MS                4.75               4             19.4          4.40\n5 other    GP                6.09               5.5           25.0          5.00\n6 other    MS                3                  2.5           11.7          3.42\n7 reputat… GP                5.58               4             54.2          7.36\n8 reputat… MS                5.2                2             51.7          7.19\n# ℹ 1 more variable: absences.x_IQR <dbl>\n\n[[3]]\n# A tibble: 8 × 7\n# Groups:   reason [4]\n  reason     school G3.x_mean G3.x_median G3.x_var G3.x_sd G3.x_IQR\n  <chr>      <chr>      <dbl>       <dbl>    <dbl>   <dbl>    <dbl>\n1 course     GP          10.4        11      21.8     4.67     4.75\n2 course     MS          10.1        10      21.0     4.58     4   \n3 home       GP          11.1        11      18.0     4.24     5   \n4 home       MS          10.4        10       9.98    3.16     2.25\n5 other      GP          12.1        12      13.8     3.71     5   \n6 other      MS           9.5        10.5    18.6     4.31     3   \n7 reputation GP          12.0        12      13.9     3.73     5   \n8 reputation MS           9.2        10      48.7     6.98     5   \n```\n\n\n:::\n:::\n\n\n\n# Correlation Matrix\n\n## correlation matrix of three target variables\n\nThe correlation matrix below shows how three numeric variables: age, mathematics absences, and final mathematics assessment are correlated with each other. There are no particularly strong linear associations between the three variables.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncombined |>\n  select(age, absences.x, G3.x) |>\n  cor()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  age  absences.x        G3.x\nage         1.0000000  0.14392517 -0.20603186\nabsences.x  0.1439252  1.00000000 -0.02811847\nG3.x       -0.2060319 -0.02811847  1.00000000\n```\n\n\n:::\n:::\n\n\n\n## correlation matrix for all numeric variables in combined dataset\n\nFor reference, a correlation matrix can easily be computed for all numeric variables in the dataset by taking advantage of the where(is.numeric) function. To properly interpret these some of these correlations prior knowledge is needed as some are discrete numerical values and others may be coded numeric values that represent categorical or ordinal data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncombined |>\n  select(where(is.numeric)) |>\n  cor()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                    age         Medu         Fedu   traveltime    studytime\nage         1.000000000 -0.100949786 -0.107245313  0.160281754  0.043881028\nMedu       -0.100949786  1.000000000  0.621523869 -0.218794954  0.045425978\nFedu       -0.107245313  0.621523869  1.000000000 -0.193978042 -0.039289626\ntraveltime  0.160281754 -0.218794954 -0.193978042  1.000000000 -0.103243249\nstudytime   0.043881028  0.045425978 -0.039289626 -0.103243249  1.000000000\nfailures    0.243429617 -0.125608045 -0.157496645  0.104521138 -0.179515785\nfamrel      0.049940980 -0.067657746 -0.047260992 -0.027275744  0.001381660\nfreetime   -0.045824466  0.004013326 -0.001258667 -0.055899592 -0.091829632\ngoout       0.150794790  0.065832096  0.050593936  0.006559725 -0.009403345\nDalc        0.113952023  0.062866542  0.039126588  0.161272613 -0.172278644\nWalc        0.156817685 -0.004099434  0.023315814  0.105381347 -0.232402574\nhealth     -0.113225976 -0.011497172  0.067152933  0.020869407 -0.040979063\nabsences.x  0.143925170  0.099832689  0.024617771 -0.001464243 -0.082387919\nG1.x       -0.110379348  0.193071603  0.175557917 -0.088080745  0.125691378\nG2.x       -0.186187399  0.188735230  0.150418214 -0.184594967  0.089030600\nG3.x       -0.206031862  0.187754424  0.141990610 -0.165110961  0.045402243\nabsences.y  0.047331821  0.063530536  0.086614161  0.054308059 -0.134969383\nG1.y       -0.050549678  0.181423706  0.115531025 -0.178191662  0.229739293\nG2.y        0.029366456  0.189642017  0.136994424 -0.179611557  0.231059730\nG3.y       -0.009103257  0.158979933  0.107807478 -0.153616466  0.238553746\n              failures      famrel     freetime        goout        Dalc\nage         0.24342962  0.04994098 -0.045824466  0.150794790  0.11395202\nMedu       -0.12560804 -0.06765775  0.004013326  0.065832096  0.06286654\nFedu       -0.15749664 -0.04726099 -0.001258667  0.050593936  0.03912659\ntraveltime  0.10452114 -0.02727574 -0.055899592  0.006559725  0.16127261\nstudytime  -0.17951579  0.00138166 -0.091829632 -0.009403345 -0.17227864\nfailures    1.00000000  0.09437401  0.089757964  0.097119445  0.16213974\nfamrel      0.09437401  1.00000000  0.090946059  0.033058834 -0.05737989\nfreetime    0.08975796  0.09094606  1.000000000  0.243271162  0.20497133\ngoout       0.09711944  0.03305883  0.243271162  1.000000000  0.25703214\nDalc        0.16213974 -0.05737989  0.204971335  0.257032140  1.00000000\nWalc        0.16736348 -0.12634267  0.119021094  0.378591514  0.64989386\nhealth      0.04225577  0.13959656  0.070864701 -0.049000564  0.05996329\nabsences.x  0.12006863 -0.04806901 -0.046300383  0.078848996  0.15159884\nG1.x       -0.19581035 -0.05618075 -0.017100766 -0.115882796 -0.09641793\nG2.x       -0.16669179 -0.08710139 -0.029677027 -0.158978350 -0.05916707\nG3.x       -0.14303203 -0.01797570 -0.006516202 -0.118423233 -0.04696434\nabsences.y  0.13424264 -0.02955203 -0.011429255  0.128521823  0.10753855\nG1.y       -0.26927657 -0.06419546 -0.085629896 -0.071905764 -0.23398211\nG2.y       -0.26992597 -0.02441686 -0.087231866 -0.091151551 -0.25300707\nG3.y       -0.32775690 -0.01282948 -0.110638817 -0.073423265 -0.27992305\n                   Walc       health   absences.x        G1.x        G2.x\nage         0.156817685 -0.113225976  0.143925170 -0.11037935 -0.18618740\nMedu       -0.004099434 -0.011497172  0.099832689  0.19307160  0.18873523\nFedu        0.023315814  0.067152933  0.024617771  0.17555792  0.15041821\ntraveltime  0.105381347  0.020869407 -0.001464243 -0.08808075 -0.18459497\nstudytime  -0.232402574 -0.040979063 -0.082387919  0.12569138  0.08903060\nfailures    0.167363479  0.042255769  0.120068630 -0.19581035 -0.16669179\nfamrel     -0.126342672  0.139596565 -0.048069014 -0.05618075 -0.08710139\nfreetime    0.119021094  0.070864701 -0.046300383 -0.01710077 -0.02967703\ngoout       0.378591514 -0.049000564  0.078848996 -0.11588280 -0.15897835\nDalc        0.649893859  0.059963287  0.151598836 -0.09641793 -0.05916707\nWalc        1.000000000  0.070450703  0.208026186 -0.07964360 -0.06540510\nhealth      0.070450703  1.000000000  0.012122515 -0.06155381 -0.07666718\nabsences.x  0.208026186  0.012122515  1.000000000 -0.06946116 -0.07580245\nG1.x       -0.079643599 -0.061553810 -0.069461164  1.00000000  0.86588796\nG2.x       -0.065405098 -0.076667185 -0.075802450  0.86588796  1.00000000\nG3.x       -0.027623053 -0.047513775 -0.028118470  0.81859418  0.91357599\nabsences.y  0.150366322 -0.001077612  0.563815592 -0.08760610 -0.12636236\nG1.y       -0.158160549 -0.126244006 -0.092477610  0.59293522  0.54300736\nG2.y       -0.183295800 -0.170419288 -0.145164017  0.59517224  0.56521350\nG3.y       -0.182606733 -0.162249671 -0.135726385  0.54388734  0.49603265\n                   G3.x   absences.y        G1.y        G2.y         G3.y\nage        -0.206031862  0.047331821 -0.05054968  0.02936646 -0.009103257\nMedu        0.187754424  0.063530536  0.18142371  0.18964202  0.158979933\nFedu        0.141990610  0.086614161  0.11553102  0.13699442  0.107807478\ntraveltime -0.165110961  0.054308059 -0.17819166 -0.17961156 -0.153616466\nstudytime   0.045402243 -0.134969383  0.22973929  0.23105973  0.238553746\nfailures   -0.143032028  0.134242644 -0.26927657 -0.26992597 -0.327756897\nfamrel     -0.017975700 -0.029552034 -0.06419546 -0.02441686 -0.012829483\nfreetime   -0.006516202 -0.011429255 -0.08562990 -0.08723187 -0.110638817\ngoout      -0.118423233  0.128521823 -0.07190576 -0.09115155 -0.073423265\nDalc       -0.046964337  0.107538550 -0.23398211 -0.25300707 -0.279923052\nWalc       -0.027623053  0.150366322 -0.15816055 -0.18329580 -0.182606733\nhealth     -0.047513775 -0.001077612 -0.12624401 -0.17041929 -0.162249671\nabsences.x -0.028118470  0.563815592 -0.09247761 -0.14516402 -0.135726385\nG1.x        0.818594184 -0.087606100  0.59293522  0.59517224  0.543887345\nG2.x        0.913575991 -0.126362360  0.54300736  0.56521350  0.496032649\nG3.x        1.000000000 -0.116640460  0.52288461  0.54545279  0.475956497\nabsences.y -0.116640460  1.000000000 -0.09864117 -0.12070727 -0.071452010\nG1.y        0.522884610 -0.098641173  1.00000000  0.88415041  0.825414320\nG2.y        0.545452789 -0.120707273  0.88415041  1.00000000  0.894309821\nG3.y        0.475956497 -0.071452010  0.82541432  0.89430982  1.000000000\n```\n\n\n:::\n:::\n\n\n\n# Scatterplot Analyses\n\n## Scatterplot 1 Math G3 Scores by Math Absences by school\n\nIn the scatterplot below, each dot represents a student's unique combination of school they attend, mathematics absences and math G3 score. What school they attended is noted by their dot color.\n\nMost students had below 20 absences, and those with more tended to score worse on the assessment. Students in the MS school had fewer absences as a group than those in the GP school and they account for none of the outliers.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngs <- ggplot(combined, aes(x = absences.x, y = G3.x, color = school_f.x))\ngs + geom_point() + geom_jitter(alpha = 0.5) + labs(x = \"Math Absences\", y = \"Math G3 Score\")\n```\n\n::: {.cell-output-display}\n![](homework5_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n\n## Scatterplot 2 Math G3 Scores by Math G1 Scores by Sex\n\nThis scatterplot shows a strong linear relationship between the mathematics G1 score and the mathematics G3 score. Dot color denotes sex. The relationship appears consistent across sex.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngs2 <- ggplot(combined, aes(x = G1.x, y = G3.x, color = sex_f.x))\ngs2 + geom_point() + geom_jitter(alpha = 0.5) + labs(x = \"Math G1 Score\", y = \"Math G3 Score\")\n```\n\n::: {.cell-output-display}\n![](homework5_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n\n## Scatterplot 2 Math G3 Scores by Math G2 Scores by Sex\n\nBelow you can see the linear relationship between G3 and G2 is even stronger than G3 and G1 in the previous plot. The data points are bunched much closer to each other.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngs2 <- ggplot(combined, aes(x = G2.x, y = G3.x, color = sex_f.x))\ngs2 + geom_point() + geom_jitter(alpha = 0.5) + labs(x = \"Math G1 Score\", y = \"Math G3 Score\")\n```\n\n::: {.cell-output-display}\n![](homework5_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n\n## Scatterplot with facet\n\nThis plot shows a different presentation of the above information. Instead of each dot being a distinct color - males and females have their own scatterplot side by side. The male scores appear slightly more widely dispersed than the female scores.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngs2 <- ggplot(combined, aes(x = G1.x, y = G3.x))\ngs2 + geom_point() + geom_jitter(alpha = 0.5) + labs(x = \"Math G1 Score\", y = \"Math G3 Score\") + facet_wrap(~sex_f.x) + theme_light()\n```\n\n::: {.cell-output-display}\n![](homework5_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n\n## Scatterplot with multi categorical facet\n\nMore than one categorical value can be used to research the G1 to G3 relationship. The 4x2 plot below shows this relationship by sex and by math study time. The same positive linear relationship is seen across all plots though fewer students studied more than 10 hours than any other study time category.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngs3 <- ggplot(combined, aes(x = G1.x, y = G3.x))\ngs3 + geom_point() + geom_jitter(alpha = 0.5) + labs(x = \"Math G1 Score\", y = \"Math G3 Score\") + \n      facet_grid(rows = vars(studytime_f.x), cols = vars(sex_f.x))\n```\n\n::: {.cell-output-display}\n![](homework5_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "homework5_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}